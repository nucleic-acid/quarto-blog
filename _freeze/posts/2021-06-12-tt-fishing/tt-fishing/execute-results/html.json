{
  "hash": "44e60cc4b110933458f1fcd0f08adb1a",
  "result": {
    "markdown": "---\ntitle: \"TidyTuesday 2021 week 24: Great Lakes Commercial Fishing\"\nsubtitle: |\n  An analysis of the commercial fish production in the Great Lakes 1867 - 2015. Using beeswarm plots to produce schools of fish. My very first submission for #TidyTuesday!\ndate: 2021-06-14\ndraft: false\ncategories:\n  - R\n  - tidy tuesday\n  - experimental\n  - environment\nimage: images/preview_fish.png\n---\n\n\n\n\n:::{.callout-note collapse=true appearance='default' icon=true}\n## Updates\n2022-09-18\n: ported to quarto\n:::\n\n## About Tidy Tuesday and The Data\n\nThe #TidyTuesday is a project by the \"R for Data Science Online Learning Community\". Each week a well documented dataset provided for the community to explore and visualize. Further information can be found in the [github repository](https://github.com/rfordatascience/tidytuesday).\n\nIn week 24 of 2021 the provided dataset is on the commercial fishing production of the Great Lakes (Erie, Superior and Michigan). The dataset description and links to further resources can be found in [this weeks data repository](https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-06-08).\n\nThanks to the [Great Lakes Fishery Commission](http://www.glfc.org/great-lakes-databases.php) for providing the data openly and thanks to the R for Data Science project for cleaning and preparing the dataset.\n\n## Schools of Fish\n\nThis is a rather short post, as time ran out before the next release of Tidy Tuesday. I wanted to play around with using icons within plots and the result is an implementation of beeswarm plots that resemble schools of fish. The raw code ^[executable without my blog specific ressources] can be found [in my repository](https://github.com/nucleic-acid/TidyTuesdaySubmissions/tree/main/2021_week_24). Below is the code to produce the blog version of the plot.\n\n### Libraries and Setup\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(emojifont)\nlibrary(ggbeeswarm)\n```\n:::\n\n\n\n## Loading and Inspecting the Data\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntuesdata <- tidytuesdayR::tt_load('2021-06-08')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> \tDownloading file 1 of 2: `stocked.csv`\n#> \tDownloading file 2 of 2: `fishing.csv`\n```\n:::\n\n```{.r .cell-code}\nglimpse(tuesdata$fishing)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 65,706\n#> Columns: 7\n#> $ year        <dbl> 1991, 1991, 1991, 1991, 1991, 1991, 1992, 1992, 1992, 1992…\n#> $ lake        <chr> \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"E…\n#> $ species     <chr> \"American Eel\", \"American Eel\", \"American Eel\", \"American …\n#> $ grand_total <dbl> 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#> $ comments    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n#> $ region      <chr> \"Michigan (MI)\", \"New York (NY)\", \"Ohio (OH)\", \"Pennsylvan…\n#> $ values      <dbl> 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n```\n:::\n\n```{.r .cell-code}\nfishing <- tuesdata$fishing\nhead(fishing) |> knitr::kable()\n```\n\n::: {.cell-output-display}\n| year|lake |species      | grand_total|comments |region            | values|\n|----:|:----|:------------|-----------:|:--------|:-----------------|------:|\n| 1991|Erie |American Eel |           1|NA       |Michigan (MI)     |      0|\n| 1991|Erie |American Eel |           1|NA       |New York (NY)     |      0|\n| 1991|Erie |American Eel |           1|NA       |Ohio (OH)         |      0|\n| 1991|Erie |American Eel |           1|NA       |Pennsylvania (PA) |      0|\n| 1991|Erie |American Eel |           1|NA       |U.S. Total        |      0|\n| 1991|Erie |American Eel |           1|NA       |Canada (ONT)      |      1|\n:::\n\n```{.r .cell-code}\nglimpse(fishing)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 65,706\n#> Columns: 7\n#> $ year        <dbl> 1991, 1991, 1991, 1991, 1991, 1991, 1992, 1992, 1992, 1992…\n#> $ lake        <chr> \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"Erie\", \"E…\n#> $ species     <chr> \"American Eel\", \"American Eel\", \"American Eel\", \"American …\n#> $ grand_total <dbl> 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#> $ comments    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n#> $ region      <chr> \"Michigan (MI)\", \"New York (NY)\", \"Ohio (OH)\", \"Pennsylvan…\n#> $ values      <dbl> 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n```\n:::\n:::\n\n\n### Cleaning\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfishing_clean <- fishing |>\n  mutate(\n    species = case_when(\n      str_detect(species, \"[Cc]atfish|[Bb]ullhead\") ~ \"Channel Catfish and Bullheads\",\n      str_detect(species, \"[Cc]isco|[Cc]hub\") ~ \"Cisco and Chubs\",\n      str_detect(species, \"[Ww]alleye|(Blue Pike)\") ~ \"Walleye and Blue Pike\",\n      str_detect(species, \"[Rr]ock [Bb]ass|[Cc]rappie\") ~ \"Rock Bass and Crappie\",\n      str_detect(species, \"[Pp]acific [Ss]almon\") ~ \"Pacific Salmon\",\n      TRUE ~ species\n    )\n  ) |>\n  filter(\n    region %in% c(\"U.S. Total\", \"Total Canada (ONT)\"),\n    !is.na(values)\n  ) |>\n  group_by(species, year) |>\n  mutate(yearly_total_US_CA = sum(values)) |> \n  distinct(year, species, yearly_total_US_CA)\n\n \nfishing_filtered <- fishing_clean |> \n  group_by(species) |> \n  summarise(t = sum(yearly_total_US_CA)) |>\n  filter(t > 500000)\n\nfishing_final <- fishing_clean |> \n  right_join(fishing_filtered, by = \"species\")\n```\n:::\n\n### Visualizations\n\nThis is a classical line plot showing the commercial production over time for the six most prominent species:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfishing_final |> \n  ggplot(\n    aes(year, yearly_total_US_CA, color = species)\n  ) +\n  labs(\n    title = \"Yearly production of fish in the Great Lakes\",\n    subtitle = \"Combined (US + CA) commercial production of the 6 most prominent species\\nof fish in Lakes Erie, Michigan, Superior.\",\n    x = \"Year\",\n    y = \"Commercially produced fish in 1000 pounds\",\n    caption = \"jollydata.blog 2021\\nData Source: Great Lakes Fishery Commission.\"\n  ) +\n  geom_line() +\n  jolly_theme()\n```\n\n::: {.cell-output-display}\n![](tt-fishing_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nThe experimental plot with the beeswarm plots looks like this^[Explanation in the alt-text of the plot]:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlist.emojifonts()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"EmojiOne.ttf\"      \"OpenSansEmoji.ttf\"\n```\n:::\n\n```{.r .cell-code}\nload.fontawesome()\nload.emojifont(\"OpenSansEmoji.ttf\")\nsearch_emoji('fish')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"tropical_fish\"         \"fish\"                  \"blowfish\"             \n#> [4] \"fish_cake\"             \"fishing_pole_and_fish\"\n```\n:::\n\n```{.r .cell-code}\nfishing_final |> \n  mutate(ktonnes = round(yearly_total_US_CA * 0.4535924 * 0.001)) |> \n  uncount(ktonnes) |> \n  ggplot(aes(x=species, y=year, color = species)) +\n    geom_text(label = emoji(\"fish\"), family=\"OpenSansEmoji\", size=4, alpha = 0.3, position = position_quasirandom(bandwidth = 0.75, varwidth = F)) +\n    # geom_quasirandom() +\n    labs(\n      title = \"Commercial Fish Production in the Great Lakes 1867-2015\",\n      subtitle = \"Combined (US + CA) commercial production of the 6 most prominent species\\nof fish in Lakes Erie, Michigan, Superior.\",\n      x = \"Species\\n(Each fish-icon represents 1000 tonnes of produced fish.)\",\n      y = \"Year\",\n      caption = \"\\nSource: Great Lakes Fishery Commission | by jollydata.blog 2021 for week 24 of #TidyTuesday\"\n    ) +\n    scale_y_continuous(\n      breaks = c(1900, 1950, 2000), \n      minor_breaks = c(1870, 1880, 1890, 1910, 1920, 1930, 1940, 1960, 1970, 1980, 1990, 2010)\n      ) +\n    scale_color_manual(values =  c(\"#F39F5C\", \"#EC836D\", \"#2D7F89\", \"#E86B72\", \"#29BCCE\", \"#56BB83\")) +\n    coord_flip() +\n    jolly_theme() +\n    theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](tt-fishing_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' fig-alt='Beeswarm plot showing the amount of commercial production of 6 fish species in the Great Lakes from 1867 to 2015. The rather experimental implementation of horizontal beeswarm plots depicts fish-icons as points within the swarm, each icon representing 1000 tonnes of produced fish. Accordingly, in years of high production the beeswarm is thicker and shows more icons.' width=100%}\n:::\n\n```{.r .cell-code}\nggsave(last_plot(), filename = \"images/2021-24_TT_fishing.pdf\",device = \"pdf\", \n                width = 10, height = 20, dpi = 500)\n```\n:::\n\nA (rather large) PDF version of the plot can be found [here](images/2021-24_TT_fishing.pdf).\n\n## Conclusion\nThe resulting plot gives an overview of the relative yearly productions, similar to a stream plot, without going into too much detail. It shows that there was a relatively short period of an \"Alewife burst\" coinciding with drastically reduced productions of Cisco, Chubs, Lake Trouts, Walley and Blue Pike.\n\nI enjoyed playing around with the `{ggbeeswarm}` package and `{emojifont}` package. Getting the latter one to work in the intended way was rather tedious, but possible in the end.",
    "supporting": [
      "tt-fishing_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/panelset-0.2.6/panelset.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/panelset-0.2.6/panelset.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}